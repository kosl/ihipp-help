<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5385519-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-5385519-3');
</script><title>omp_target_associate_ptr</title> 
<meta  charset="iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="openmp.css" /> 
<meta name="src" content="openmp.tex" /> 
</head><body 
>
<div class="page-heading-wrapper"><div class="page-heading-home"><a href="./openmp.html">HOME</a></div><div class="page-heading"> | <strong>OPENMP API Specification: Version 5.1 November 2020</strong></div></div> <!--l. 832--><div class="crosslinks"><p class="noindent">[<a 
href="openmpsu177.html" >next</a>] [<a 
href="openmpsu175.html" >prev</a>] [<a 
href="openmpsu175.html#tailopenmpsu175.html" >prev-tail</a>] [<a 
href="#tailopenmpsu176.html">tail</a>] [<a 
href="openmpse38.html#openmpsu176.html" >up</a>] </p></div>
<h4 class="subsectionHead"><span class="titlemark">3.8.9</span>&#x00A0;&#x00A0;<a 
 id="x221-2540003.8.9"></a><span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span></h4>
<a 
 id="dx221-254001"></a>
<p><p><a 
 id="Q1-221-1194"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Summary</span>
The <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> routine maps a device pointer, which may be returned from
<span class="textbf"><span class="texttt">omp_target_alloc</span></span> or implementation-defined runtime routines, to a host pointer.
<p><a 
 id="Q1-221-1195"></a>
<span 
class="phvb8t-x-x-110">Format</span>
 <div class="section-wrapper"><div class="section-heading"><div class="section-ccppspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-3.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254002r1"></a></span></p> 
<!--l. 843--><pre class="listings"><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254003r2"></a></span><span 
class="pcrb8t-">int</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">omp_target_associate_ptr</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254004r3"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">const</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">void</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">*</span><span 
class="ec-qtmri-">host_ptr</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254005r4"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">const</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">void</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">*</span><span 
class="ec-qtmri-">device_ptr</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254006r5"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">size_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">size</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254007r6"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">size_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_offset</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254008r7"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">int</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_num</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254009r8"></a></span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">;</span>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254010r9"></a></span></pre>
<p><object data="openmp-4.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</div></div>
<p> <div class="section-wrapper"><div class="section-heading"><div class="section-fortranspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-11.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254011r1"></a></span></p> 
<!--l. 855--><pre class="listings"><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254012r2"></a></span><span 
class="pcrb8t-">integer</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">c_int</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">function</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">omp_target_associate_ptr</span><span 
class="pcrb8t-">(</span><span 
class="ec-qtmri-">host_ptr</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&amp;</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254013r3"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_ptr</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">size</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_offset</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_num</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">bind</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">c</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254014r4"></a></span><span 
class="pcrb8t-">use</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">intrinsic</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">::</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">iso_c_binding</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">only</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">:</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">c_ptr</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">c_size_t</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">c_int</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254015r5"></a></span><span 
class="pcrb8t-">type</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">c_ptr</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">value</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">::</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">host_ptr</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_ptr</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254016r6"></a></span><span 
class="pcrb8t-">integer</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">c_size_t</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">value</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">::</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">size</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_offset</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254017r7"></a></span><span 
class="pcrb8t-">integer</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">c_int</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">value</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">::</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">device_num</span>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x221-254018r8"></a></span></pre>
<p><object data="openmp-12.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
<p></div></div>
</p> 
<p><p><a 
 id="Q1-221-1196"></a>
<span 
class="phvb8t-x-x-110">Constraints on Arguments</span>
The value of <span class="textit"><span class="textrm">device_ptr</span></span> value must be a valid pointer to device memory for the device denoted by the value
of <span class="textit"><span class="textrm">device_num</span></span>. The <span class="textit"><span class="textrm">device_num</span></span> argument must be greater than or equal to zero and less than or equal to the
result of <span class="textbf"><span class="texttt">omp_get_num_devices()</span></span>.
</p> 
<p><p><a 
 id="Q1-221-1197"></a>
<span 
class="phvb8t-x-x-110">Binding</span>
The binding task set for an <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> region is the generating task, which is the
<span class="textit"><span class="textrm">target task</span></span> generated by the call to the <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> routine.
</p> 
<p><p><a 
 id="Q1-221-1198"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Effect</span>
The <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> routine associates a device pointer in the device data environment
of device <span class="textit"><span class="textrm">device_num</span></span> with a host pointer such that when the host pointer appears in a subsequent <span class="textbf"><span class="texttt">map</span></span>
clause, the associated device pointer is used as the target for data motion associated with that host pointer.
The <span class="textit"><span class="textrm">device_offset</span></span> parameter specifies the offset into <span class="textit"><span class="textrm">device_ptr</span></span> that is used as the base address for the device
side of the mapping. The reference count of the resulting mapping will be infinite. After being
successfully associated, the buffer to which the device pointer points is invalidated and accessing data
directly through the device pointer results in unspecified behavior. The pointer can be retrieved
for other uses by using the <span class="textbf"><span class="texttt">omp_target_disassociate_ptr</span></span> routine to disassociate it
.
</p> 
<p>The <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> routine executes as if part of a target task that is generated by the
call to the routine and that is an included task.
</p> 
<p>The routine returns zero if successful. Otherwise it returns a non-zero value.
</p> 
<p>Only one device buffer can be associated with a given host pointer value and device number pair.
Attempting to associate a second buffer will return non-zero. Associating the same pair of pointers on the
same device with the same offset has no effect and returns zero. Associating pointers that share underlying
storage will result in unspecified behavior. The <span class="textbf"><span class="texttt">omp_target_is_present</span></span> function can
be used to test whether a given host pointer has a corresponding variable in the device data
environment.
</p> 
<p> <div class="section-wrapper"><div class="section-heading"><div class="section-fortranspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-11.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</p> 
<p>The <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> routine requires an explicit interface and so might not be provided
in <span class="textbf"><span class="texttt">omp_lib.h</span></span>.
</p> 
<p><p><object data="openmp-12.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</p> 
<p></div></div>
</p> 
<p><p><a 
 id="Q1-221-1199"></a>
<span 
class="phvb8t-x-x-110">Execution Model Events</span>
The <span class="textit"><span class="textrm">target-data-associate</span></span> event occurs before a thread initiates a device pointer association on a target
device.
</p> 
<p><p><a 
 id="Q1-221-1200"></a>
<span 
class="phvb8t-x-x-110">Tool Callbacks</span>
A thread dispatches a registered <span class="textbf"><span class="texttt">ompt_callback_target_data_op</span></span> callback, or a registered
<span class="textbf"><span class="texttt">ompt_callback_target_data_op_emi</span></span> callback with <span class="textbf"><span class="texttt">ompt_scope_beginend</span></span> as its endpoint
argument for each occurrence of a <span class="textit"><span class="textrm">target-data-associate</span></span> event in that thread. These callbacks have type
signature <span class="textbf"><span class="texttt">ompt_callback_target_data_op_t</span></span> or <span class="textbf"><span class="texttt">ompt_callback_target_data_op_emi_t</span></span>,
respectively.
</p> 
<p><p><a 
 id="Q1-221-1201"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Restrictions</span>
Restrictions to the <span class="textbf"><span class="texttt">omp_target_associate_ptr</span></span> routine are as follows.
</p> 

  <ul class="itemize1">
  <li class="itemize">
  When
  called
  from
  within
  a
  <span class="textbf"><span class="texttt">target</span></span>
  region
  the
  effect
  is
  unspecified.</li></ul>
<p><p><a 
 id="Q1-221-1202"></a>
<span 
class="phvb8t-x-x-110">Cross References</span>
</p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">target</span></span>
  construct,
  see
  Section&#x00A0;<a 
href="openmpsu68.html#x96-1060002.14.5">2.14.5<!--tex4ht:ref: subsec:target Construct --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">map</span></span>
  clause,
  see
  Section&#x00A0;<a 
href="openmpsu119.html#x154-1840002.21.7.1">2.21.7.1<!--tex4ht:ref: subsec:map Clause --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">omp_get_num_devices</span></span>
  routine,
  see
                                                                            
                                                                            
  Section&#x00A0;<a 
href="openmpsu164.html#x208-2410003.7.4">3.7.4<!--tex4ht:ref: subsec:omp_get_num_devices --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">omp_target_alloc</span></span>
  routine,
  see
  Section&#x00A0;<a 
href="openmpsu168.html#x213-2460003.8.1">3.8.1<!--tex4ht:ref: subsec:omp_target_alloc --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">omp_target_is_present</span></span>
  routine,
  see
  Section&#x00A0;<a 
href="openmpsu170.html#x215-2480003.8.3">3.8.3<!--tex4ht:ref: subsec:omp_target_is_present --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">omp_target_disassociate_ptr</span></span>
  routine,
  see
  Section&#x00A0;<a 
href="openmpsu177.html#x222-2550003.8.10">3.8.10<!--tex4ht:ref: subsec:omp_target_disassociate_ptr --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">omp_get_mapped_ptr</span></span>
  routine,
  see
  Section&#x00A0;<a 
href="openmpsu178.html#x223-2560003.8.11">3.8.11<!--tex4ht:ref: subsec:omp_get_mapped_ptr --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompt_callback_target_data_op_t</span></span>
  or
  <span class="textbf"><span class="texttt">ompt_callback_target_data_op_emi_t</span></span>
  callback
  type,
  see
  Section&#x00A0;<a 
href="openmpsu214.html#x272-3670004.5.2.25">4.5.2.25<!--tex4ht:ref: sec:ompt_callback_target_data_op_emi_t --></a>.</li></ul>
<!--l. 952--><div class="crosslinks"><p class="noindent">[<a 
href="openmpsu177.html" >next</a>] [<a 
href="openmpsu175.html" >prev</a>] [<a 
href="openmpsu175.html#tailopenmpsu175.html" >prev-tail</a>] [<a 
href="openmpsu176.html" >front</a>] [<a 
href="openmpse38.html#openmpsu176.html" >up</a>] </p></div>
                                                                            
                                                                            
<p><a 
 id="tailopenmpsu176.html"></a> </p> 
 
</body> 
</html>