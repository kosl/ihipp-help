<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-5385519-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-5385519-3');
</script><title>Per OMPD Library Initialization and Finalization</title> 
<meta  charset="iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="openmp.css" /> 
<meta name="src" content="openmp.tex" /> 
</head><body 
>
<div class="page-heading-wrapper"><div class="page-heading-home"><a href="./openmp.html">HOME</a></div><div class="page-heading"> | <strong>OPENMP API Specification: Version 5.1 November 2020</strong></div></div> <!--l. 25--><div class="crosslinks"><p class="noindent">[<a 
href="openmpsu241.html" >next</a>] [<a 
href="openmpse56.html" >prev</a>] [<a 
href="openmpse56.html#tailopenmpse56.html" >prev-tail</a>] [<a 
href="#tailopenmpsu240.html">tail</a>] [<a 
href="openmpse56.html#openmpsu240.html" >up</a>] </p></div>
<h4 class="subsectionHead"><span class="titlemark">5.5.1</span>&#x00A0;&#x00A0;<a 
 id="x305-4450005.5.1"></a>Per OMPD Library Initialization and Finalization</h4>
<p>The OMPD library must be initialized exactly once after it is loaded, and finalized exactly once
before it is unloaded. Per OpenMP process or core file initialization and finalization are also
required.
</p> 
<p>Once loaded, the tool can determine the version of the OMPD API that the library supports by
calling <span class="textbf"><span class="texttt">ompd_get_api_version</span></span> (see Section&#x00A0;<a 
href="#x305-4470005.5.1.2">5.5.1.2<!--tex4ht:ref: subsubsubsec:ompd_get_api_version --></a>). If the tool supports the version that
<span class="textbf"><span class="texttt">ompd_get_api_version</span></span> returns, the tool starts the initialization by calling <span class="textbf"><span class="texttt">ompd_initialize</span></span> (see
Section&#x00A0;<a 
href="#x305-4460005.5.1.1">5.5.1.1<!--tex4ht:ref: subsubsubsec:ompd_initialize --></a>) using the version of the OMPD API that the library supports. If the tool does not support
the version that <span class="textbf"><span class="texttt">ompd_get_api_version</span></span> returns, it may attempt to call <span class="textbf"><span class="texttt">ompd_initialize</span></span> with a
different version.
</p> 
<p>
</p> 

<h5 class="subsubsectionHead"><span class="titlemark">5.5.1.1  </span> <a 
 id="x305-4460005.5.1.1"></a><span class="textbf"><span class="texttt">ompd_initialize</span></span></h5>
<p><p><a 
 id="Q1-305-2147"></a>
<span 
class="phvb8t-x-x-110">Summary</span>
The <span class="textbf"><span class="texttt">ompd_initialize</span></span> function initializes the OMPD library.
<p><a 
 id="Q1-305-2148"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Format</span>
 <div class="section-wrapper"><div class="section-heading"><div class="section-cspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-1.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-446001r1"></a></span></p> 
<!--l. 51--><pre class="listings"><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-446002r2"></a></span><span 
class="pcrb8t-">ompd_rc_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">ompd_initialize</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-446003r3"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">ompd_word_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="ec-qtmri-">api_version</span><span 
class="pcrb8t-">,</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-446004r4"></a></span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">const</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">ompd_callbacks_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">*</span><span 
class="ec-qtmri-">callbacks</span><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-446005r5"></a></span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">;</span>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-446006r6"></a></span></pre>
<p><object data="openmp-2.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</div></div>
<p><p><a 
 id="Q1-305-2149"></a>
<span 
class="phvb8t-x-x-110">Description</span>
A tool that uses OMPD calls <span class="textbf"><span class="texttt">ompd_initialize</span></span> to initialize each OMPD library that it loads. More than
one library may be present in a third-party tool, such as a debugger, because the tool may control multiple
devices, which may use different runtime systems that require different OMPD libraries. This initialization
must be performed exactly once before the tool can begin to operate on an OpenMP process or core
file.
</p> 
<p><p><a 
 id="Q1-305-2150"></a>
<span 
class="phvb8t-x-x-110">Description of Arguments</span>
The <span class="textit"><span class="textrm">api_version</span></span> argument is the OMPD API version that the tool requests to use. The tool may call
<span class="textbf"><span class="texttt">ompd_get_api_version</span></span> to obtain the latest OMPD API version that the OMPD library
supports.
</p> 
<p>The tool provides the OMPD library with a set of callback functions in the <span class="textit"><span class="textrm">callbacks</span></span> input argument which
enables the OMPD library to allocate and to deallocate memory in the tool&#8217;s address space, to lookup the
sizes of basic primitive types in the device, to lookup symbols in the device, and to read and to write
memory in the device.
</p> 
<p><p><a 
 id="Q1-305-2151"></a>
<span 
class="phvb8t-x-x-110">Description of Return Codes</span>
This routine must return any of the general return codes listed at the beginning of Section <a 
href="openmpse56.html#x304-4440005.5">5.5<!--tex4ht:ref: subsec:ompd-api --></a> or any of the
following return codes: </p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_bad_input</span></span>
  if
  invalid
  callbacks
  are
  provided;
  or
                                                                            
                                                                            
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_unsupported</span></span>
  if
  the
  requested
  API
  version
  cannot
  be
  provided.</li></ul>
<p><p><a 
 id="Q1-305-2152"></a>
<span 
class="phvb8t-x-x-110">Cross References</span>
</p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_t</span></span>
  type,
  see
  Section&#x00A0;<a 
href="openmpsu232.html#x295-4280005.3.12">5.3.12<!--tex4ht:ref: subsubsec:ompd_rc_t --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_callbacks_t</span></span>
  type,
  see
  Section&#x00A0;<a 
href="openmpsu239.html#x303-4430005.4.6">5.4.6<!--tex4ht:ref: subsubsec:ompd_callbacks_t --></a>.
  </li>
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_get_api_version</span></span>
  routine,
  see
  Section&#x00A0;<a 
href="#x305-4470005.5.1.2">5.5.1.2<!--tex4ht:ref: subsubsubsec:ompd_get_api_version --></a>.</li></ul>
<h5 class="subsubsectionHead"><span class="titlemark">5.5.1.2  </span> <a 
 id="x305-4470005.5.1.2"></a><span class="textbf"><span class="texttt">ompd_get_api_version</span></span></h5>
<p><p><a 
 id="Q1-305-2154"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Summary</span>
The <span class="textbf"><span class="texttt">ompd_get_api_version</span></span> function returns the OMPD API version.
<p><a 
 id="Q1-305-2155"></a>
<span 
class="phvb8t-x-x-110">Format</span>
 <div class="section-wrapper"><div class="section-heading"><div class="section-cspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-1.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-447001r1"></a></span></p> 
<!--l. 106--><pre class="listings"><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-447002r2"></a></span><span 
class="pcrb8t-">ompd_rc_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">ompd_get_api_version</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">ompd_word_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">*</span><span 
class="ec-qtmri-">version</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">;</span>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-447003r3"></a></span></pre>
<p><object data="openmp-2.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</div></div>
<p><p><a 
 id="Q1-305-2156"></a>
<span 
class="phvb8t-x-x-110">Description</span>
The tool may call the <span class="textbf"><span class="texttt">ompd_get_api_version</span></span> function to obtain the latest OMPD API
version number of the OMPD library. The OMPD API version number is equal to the value of the
<span class="textbf"><span class="texttt">_OPENMP</span></span> macro defined in the associated OpenMP implementation, if the C preprocessor is
supported. If the associated OpenMP implementation compiles Fortran codes without the use of a C
preprocessor, the OMPD API version number is equal to the value of the Fortran integer parameter
<span class="textbf"><span class="texttt">openmp_version</span></span>.
</p> 
<p><p><a 
 id="Q1-305-2157"></a>
<span 
class="phvb8t-x-x-110">Description of Arguments</span>
The latest version number is returned into the location to which the <span class="textit"><span class="textrm">version</span></span> argument points.
</p> 
<p><p><a 
 id="Q1-305-2158"></a>
<span 
class="phvb8t-x-x-110">Description of Return Codes</span>
This routine must return any of the general return codes listed at the beginning of Section&#x00A0;<a 
href="openmpse56.html#x304-4440005.5">5.5<!--tex4ht:ref: subsec:ompd-api --></a>.
</p> 
<p><p><a 
 id="Q1-305-2159"></a>
<span 
class="phvb8t-x-x-110">Cross References</span>
</p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_t</span></span>
  type,
  see
  Section&#x00A0;<a 
href="openmpsu232.html#x295-4280005.3.12">5.3.12<!--tex4ht:ref: subsubsec:ompd_rc_t --></a>.</li></ul>
                                                                            
                                                                            
<h5 class="subsubsectionHead"><span class="titlemark">5.5.1.3  </span> <a 
 id="x305-4480005.5.1.3"></a><span class="textbf"><span class="texttt">ompd_get_version_string</span></span></h5>
<p><p><a 
 id="Q1-305-2161"></a>
<span 
class="phvb8t-x-x-110">Summary</span>
The <span class="textbf"><span class="texttt">ompd_get_version_string</span></span> function returns a descriptive string for the OMPD library
version.
<p><a 
 id="Q1-305-2162"></a>
<span 
class="phvb8t-x-x-110">Format</span>
 <div class="section-wrapper"><div class="section-heading"><div class="section-cspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-1.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-448001r1"></a></span></p> 
<!--l. 143--><pre class="listings"><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-448002r2"></a></span><span 
class="pcrb8t-">ompd_rc_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">ompd_get_version_string</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">const</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">char</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">**</span><span 
class="ec-qtmri-">string</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">;</span>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-448003r3"></a></span></pre>
<p><object data="openmp-2.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</div></div>
<p><p><a 
 id="Q1-305-2163"></a>
<span 
class="phvb8t-x-x-110">Description</span>
The tool may call this function to obtain a pointer to a descriptive version string of the OMPD library
vendor, implementation, internal version, date, or any other information that may be useful to a tool user or
vendor. An implementation should provide a different string for every change to its source code or build that
could be visible to the interface user.
</p> 
<p><p><a 
 id="Q1-305-2164"></a>
<span 
class="phvb8t-x-x-110">Description of Arguments</span>
A pointer to a descriptive version string is placed into the location to which the <span class="textit"><span class="textrm">string</span></span> output argument
points. The OMPD library owns the string that the OMPD library returns; the tool must not
modify or release this string. The string remains valid for as long as the library is loaded. The
<span class="textbf"><span class="texttt">ompd_get_version_string</span></span> function may be called before <span class="textbf"><span class="texttt">ompd_initialize</span></span> (see
Section&#x00A0;<a 
href="#x305-4460005.5.1.1">5.5.1.1<!--tex4ht:ref: subsubsubsec:ompd_initialize --></a>). Accordingly, the OMPD library must not use heap or stack memory for the
string.
</p> 
<p>The signatures of <span class="textbf"><span class="texttt">ompd_get_api_version</span></span> (see Section&#x00A0;<a 
href="#x305-4470005.5.1.2">5.5.1.2<!--tex4ht:ref: subsubsubsec:ompd_get_api_version --></a>) and <span class="textbf"><span class="texttt">ompd_get_version_string</span></span>
are guaranteed not to change in future versions of the API. In contrast, the type definitions and prototypes in
the rest of the API do not carry the same guarantee. Therefore a tool that uses OMPD should check
the version of the API of the loaded OMPD library before it calls any other function of the
API.
</p> 
<p><p><a 
 id="Q1-305-2165"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Description of Return Codes</span>
This routine must return any of the general return codes listed at the beginning of Section&#x00A0;<a 
href="openmpse56.html#x304-4440005.5">5.5<!--tex4ht:ref: subsec:ompd-api --></a>.
</p> 
<p><p><a 
 id="Q1-305-2166"></a>
<span 
class="phvb8t-x-x-110">Cross References</span>
</p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_t</span></span>
  type,
  see
  Section&#x00A0;<a 
href="openmpsu232.html#x295-4280005.3.12">5.3.12<!--tex4ht:ref: subsubsec:ompd_rc_t --></a>.</li></ul>
<h5 class="subsubsectionHead"><span class="titlemark">5.5.1.4  </span> <a 
 id="x305-4490005.5.1.4"></a><span class="textbf"><span class="texttt">ompd_finalize</span></span></h5>
<p><p><a 
 id="Q1-305-2168"></a>
<span 
class="phvb8t-x-x-110">Summary</span>
When the tool is finished with the OMPD library it should call <span class="textbf"><span class="texttt">ompd_finalize</span></span> before it unloads the
library.
<p><a 
 id="Q1-305-2169"></a>
<span 
class="phvb8t-x-x-110">Format</span>
 <div class="section-wrapper"><div class="section-heading"><div class="section-cspecific"></div></div><div class="section-contents">
</p> 
<p><p><object data="openmp-1.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-449001r1"></a></span></p> 
<!--l. 191--><pre class="listings"><span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-449002r2"></a></span><span 
class="pcrb8t-">ompd_rc_t</span><span 
class="pcrb8t-">&#x00A0;</span><span 
class="pcrb8t-">ompd_finalize</span><span 
class="pcrb8t-">(</span><span 
class="pcrb8t-">void</span><span 
class="pcrb8t-">)</span><span 
class="pcrb8t-">;</span>
 <span 
class="pcrb8t-">&#x00A0;</span><br /><span class="label"><a 
 id="x305-449003r3"></a></span></pre>
<p><object data="openmp-2.svg" width="1.0 " height="2.33333 " type="image/svg+xml"><p>SVG-Viewer needed.</p></object>
</div></div>
<p><p><a 
 id="Q1-305-2170"></a>
<span 
class="phvb8t-x-x-110">Description</span>
The call to <span class="textbf"><span class="texttt">ompd_finalize</span></span> must be the last OMPD call that the tool makes before it unloads the library.
This call allows the OMPD library to free any resources that it may be holding.
</p> 
<p>The OMPD library may implement a <span class="emph">finalizer</span> section, which executes as the library is unloaded and
therefore after the call to <span class="textbf"><span class="texttt">ompd_finalize</span></span>. During finalization, the OMPD library may use the callbacks
that the tool provided earlier during the call to <span class="textbf"><span class="texttt">ompd_initialize</span></span>.
</p> 
<p><p><a 
 id="Q1-305-2171"></a>
                                                                            
                                                                            
<span 
class="phvb8t-x-x-110">Description of Return Codes</span>
This routine must return any of the general return codes listed at the beginning of Section <a 
href="openmpse56.html#x304-4440005.5">5.5<!--tex4ht:ref: subsec:ompd-api --></a> or the
following return code: </p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_unsupported</span></span>
  if
  the
  OMPD
  library
  is
  not
  initialized.</li></ul>
<p><p><a 
 id="Q1-305-2172"></a>
<span 
class="phvb8t-x-x-110">Cross References</span>
</p> 

  <ul class="itemize1">
  <li class="itemize">
  <span class="textbf"><span class="texttt">ompd_rc_t</span></span>
  type,
  see
  Section&#x00A0;<a 
href="openmpsu232.html#x295-4280005.3.12">5.3.12<!--tex4ht:ref: subsubsec:ompd_rc_t --></a>.</li></ul>
<!--l. 219--><div class="crosslinks"><p class="noindent">[<a 
href="openmpsu241.html" >next</a>] [<a 
href="openmpse56.html" >prev</a>] [<a 
href="openmpse56.html#tailopenmpse56.html" >prev-tail</a>] [<a 
href="openmpsu240.html" >front</a>] [<a 
href="openmpse56.html#openmpsu240.html" >up</a>] </p></div>
<p><a 
 id="tailopenmpsu240.html"></a> </p> 
 
</body> 
</html>